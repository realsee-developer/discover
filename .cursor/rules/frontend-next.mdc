---
globs: frontend/**
description: Next.js 前端开发约定与导航
---

# Next.js 前端开发约定（Realsee Discover）

## 快速导航

- 脚本：`frontend/package.json` → `dev`、`build`、`start`、`lint`
- 设计：遵循 [.cursor/rules/design-system.mdc](mdc:.cursor/rules/design-system.mdc) 与 [.cursor/rules/frontend-tailwind-daisyui.mdc](mdc:.cursor/rules/frontend-tailwind-daisyui.mdc)
- 组件：`frontend/src/components`，优先复用 UI 与模块库
- 数据：`frontend/src/data` 静态源，Strapi API 通过 `lib/strapi.ts`

## 项目结构

- **App Router**：根布局 `src/app/layout.tsx`；入口路由位于 `src/app/**`
- **共享布局**：页眉/页脚在 `src/components/custom` 中维护，保持跨页一致
- **样式载入**：`src/app/globals.css` 负责 Tailwind v4 + daisyUI + 设计令牌
- **环境变量**：默认通过 `getStrapiURL()` 读取 `NEXT_PUBLIC_STRAPI_URL`（默认 `http://localhost:1337`）

## 数据获取策略

- **全局数据**：`GET /api/global` 用于布局与 `generateMetadata`
- **页面模块**：`GET /api/home-page?populate[blocks][populate]=*` 等 API，按 Strapi 模块字段渲染
- **错误兜底**：所有请求封装在 `lib/strapi.ts`，需要实现错误捕获与空状态
- **缓存策略**：服务端组件默认使用 Next.js `fetch` 缓存机制，增量更新时显式配置 `revalidate`

## TypeScript 与构建

- **路径别名**：`@/* → src/*`，定义于 `tsconfig.json`
- **Biome 配置**：`biome.json` 控制格式化和 Lint；提交前执行 `npm run lint`
- **组件类型**：保持显式 Props 类型，复用 `types.d.ts`/`@/types` 中的声明

## 渲染与组件约定

- **服务器组件优先**：除需浏览器交互的场景外保持 Server Components；客户端组件需使用 `"use client"`
- **动态模块渲染**：内容模块根据 `__component` 动态映射，示例见 `src/app/page.tsx`
- **UI 复用**：按钮使用 `components/ui/button.tsx`，卡片/徽章等遵循组件库，禁止页面内自定义 Tailwind class
- **布局网格**：页面容器遵循 `max-w-7xl mx-auto px-8`（移动端 `px-4`），跨页面一致

## 运行时与可访问性

- **SEO**：在 `generateMetadata` 中合并 Strapi `global` 数据
- **Loading/Error 状态**：提供 `loading.tsx`、`error.tsx`，并确保与设计系统一致
- **可访问性**：交互组件统一使用 `cyber-focus` 焦点样式，文本对比遵守 WCAG 2.2 AA
- **性能**：按需拆分模块，使用 Next Image/Lazy 组件，重用 `next/script` 做延迟加载

## 关联规则

- Tailwind 与 daisyUI 细节参考 [.cursor/rules/frontend-tailwind-daisyui.mdc](mdc:.cursor/rules/frontend-tailwind-daisyui.mdc)
- 设计落地与审核流程参考 [.cursor/rules/design-system.mdc](mdc:.cursor/rules/design-system.mdc)
- 不得硬编码品牌色，遵循 [.cursor/rules/no-hardcoded-brand-color.mdc](mdc:.cursor/rules/no-hardcoded-brand-color.mdc)
